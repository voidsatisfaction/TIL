# 네트워크 기초

## 나의 컴퓨터로 보는 네트워크 기초

맥의 경우 시스템 환경설정에서 네트워크를 참조

### IP 주소

- 165.132.126.159와 같은 형태
  - 1바이트.1바이트.1바이트.1바이트
  - IPv4의 경우는 32비트(4바이트)이다.
  - 8비트: 0 ~ 255 = 1바이트 = 1옥텟
- 인터페이스 마다 고유의 IP 주소가 필요하다.
  - e.g 하나의 핸드폰도 2G 3G 4G에 따라 다른 IP주소 사용
  - 이더넷과 와이파이는 같은 컴퓨터라고 해도 기본적으로 다른 IP주소를 사용한다.
  - 그러므로 하나의 전자 제품이 많은 IP 주소를 사용하게 된다.

### Subnet Mask: 서브넷 마스크

- 인터넷은 서브넷으로 나뉘어져 있다.
  - 서브넷은 또 다른 서브넷으로 나누어져 있다.
  - 라우팅 효율화
- 서브넷 마스크는 클라이언트(PC)가 연결된 서브넷의 크기에 기반한다.
- IPv4의 서브넷 마스크는 32비트
  - 왼쪽 MSB(Most Significant Bit)부터 오른쪽 LSB(Least Significant Bit)까지의 0과1의 순열로 구성
- 용도
  - IP주소를 mask(필터링)해서 해당 패킷이 특정 서브넷에 속하는지 아닌지를 빠르게 판단하기 위함
- 255.255.252.0 => 마지막에 10개의 0이 존재
  - 서브넷 마스크는 서브넷 사이즈를 찾는데에 사용되기도 한다.
  - 위의 경우에는 2^10의 IP 주소가 서브넷에 등록되어있다.
  - 하지만 모든 주소를 클라이언트가 사용할 수 있지는 않다.

### Default gateway(router): 기본 게이트웨이

- 클라이언트 컴퓨터가 모든 인터넷 IP 패킷들을 주고 받도록 해준다.
- 다른 말로 IP 라우터 라고도 한다.
- 라우터 == 게이트웨이

### DNS(Domain Name Server): 도메인 네임 서버

- 호스트네임을 IP 주소로 바꾸어주는 서버
  - 호스트네임이란
    - ???@gmail.com 에서 `gmail.com`
    - www.facebook.com 에서 `facebook`
  - 컴퓨터 안에는 메인과 서브가 있어서 메인이 고장나면 서브가 작동한다.

## DHCP(Dynamic Host Configuration Protocol)을 이용한 인터넷 셋업

스타벅스에서 공공 WiFi를 DHCP를 이용해서 제공하고있다.

- DHCP는 컴퓨터나 스마트폰이 로컬 DHCP 서버에 자동적으로 리퀘스트를 보냄
  - 인터넷에 연결하기 위한 IP 주소, 그밖의 네트워킹 인자의 리스폰스를 받고 설정함
  - DHCP 서버가 반드시 존재해야 함
- 셋업이 자동화 되어있어서 로컬 네트워크 관리자에게 인터넷 셋업을 수동으로 요청하지 않아도 됨
  - 그래서 모바일 기기에서 많이 사용
  - IPv4, IPv6에서 사용됨
- 서버에서 전송받는 데이터는 다음과 같음
  - IP 주소
  - 서브넷 마스크
  - 기본 게이트웨이의 IP 주소
  - 다른 인터넷 설정 인자들
- 장점
  - 사용하기 쉬움
  - IP주소의 재사용
    - 컴퓨터나 스마트폰이 인터넷이 필요할 때만 IP 주소를 할당받아서 사용 가능
    - 사용이 끝나면 서버가 그 주소를 다시 회수해서 다른 기기에 사용
    - 효율적인 서브넷 활용
    - IPv4의 한계 극복(2^32 < 43억 IP 주소)
- DHCP의 작용
  - 클라이언트-서버 모델
  - DHCP서버는 다음을 제어
    - IP 주소들의 풀(pools)
    - 클라이언트 정보
      - 기본 게이트웨이
      - 도메인 이름
      - 도메인 이름 서버
      - 타임 서버

### DHCP의 작동 순서

1. 클라이언트가 네트워크에 연결
2. DHCP가 UDP(User Datagram Protocol)를 사용: 클라이언트 포트 68, DHCP 서버포트 67
3. 클라이언트 DHCP 프로그램이 `Server Discovery`메시지를 브로드캐스트에 뿌림
4. 네트워크 내에 존재하는 임의의 DHCP 서버가 `IP Lease Offer`메시지를 클라이언트에게 전송
5. 클라이언트는 `IP Lease Request`메시지를 `IP Lease Offer`메시지를 보낸 서버에게 다시 보냄
6. 그것을 받은 DHCP 서버가 `IP Lease Acknowledgement`메시지를 클라이언트가 인터넷 접속에 필요한 정보들과 함꼐 일정한 `시간 제한(time limitation)`과 함께 보내준다

만일 클라이언트가 인터넷에 다시 연결하려고 하면, 컴퓨터나 스마트폰이 IP주소가 다시 필요하면 DHCP 서버는 이전과 동일한 IP주소를 주려고 하나, 네트워크 관리자의 정책에 따라서 그 주소를 반드시 할당받는다고 보장할 수 없다.

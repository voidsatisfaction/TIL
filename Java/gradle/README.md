# Gradle

- 의문
- 개요
  - 용어
    - Projects
      - Subprojects
    - Tasks
    - Plugins
    - Builds
- 기능
  - 커맨드

## 의문

## 개요

- 개요
  - 빌드 자동화 툴
- 특징
  - 높은 성능
    - build cache를 사용함
      - input 혹은 output이 변한 경우에만 태스크를 실행함
  - JVM 기반
    - 빌드시 자바 API 사용가능
  - 컨벤션
    - 플러그인은 스크립트 작성을 최소화
  - 확장성
  - IDE 지원
  - 빌드 스캔
    - 빌드시 프로파일링 가능

### 용어

빌드 > 프로젝트 > 서브프로젝트

- Projects
  - 개요
    - 그레들이 빌드하는 대상
  - 특징
    - 프로젝트의 루트 디렉터리에 있는 빌드 스크립트를 포함(`build.gradle`, `build.gradle.kts`)
    - 빌드 스크립트
      - 태스크
      - 의존성
      - 플러그인
      - 다른 설정 정보
    - 하나의 빌드는 다수의 프로젝트를 포함할 수 있고, 각각의 프로젝트는 자신만의 서브프로젝트를 포함할 수 있음
- Tasks
  - 개요
    - 특정 일을 수행하는 로직을 포함(코드 컴파일, 테스트 실행, 소프트웨어 배포)
      - 대개는 그레들이 제공하는 태스크를 사용(`Test` 등)하지만 플러그인을 사용해서 다양한 태스크를 실행 가능
  - 구성(함수같은 개념)
    - Actions
      - 무엇인가를 하는 일의 단위(파일 복사, 소스 컴파일 등)
    - Inputs
      - 액션이 사용하거나 작동하는 값, 파일, 디렉터리
    - Outputs
      - 액션이 수정하거나 생성하는 팡리이나 디렉터리들
- Plugins
  - 개요
    - 그레들 자체의 태스크, 파일, 디펜던시 설정이외에 커스텀으로 도입가능한 빌드할때의 동작
    - 로직과 설정의 재활용 수단을 여러 프로젝트에 걸쳐서 제공
  - 특징
    - 플러그인의 태스크는 여러 빌드에 재활용 가능(모듈마냥 e.g 코틀린 컴파일 플러그인은 코틀린을 사용하는 여러 빌드에 사용됨)
    - 공통 설정도 재활용 가능(로깅, 의존, 버전 관리)
- Builds
  - 개요
    - 그레들 프로젝트에서 태스크의 컬렉션을 실행하는 것
  - 특징
    - 실행은 CLI혹은 IDE를 기반으로 가능
    - 요청받은 태스크들과 의존성에 기반하여 가장 작은 태스크의 집합으로 실행함
  - 라이프 사이클
    - Initialization
      - 빌드를 위한 환경 세팅과 빌드에 참여할 프로젝트 선정
    - Configuration
      - 빌드를 위한 태스크 그래프 설정
    - Execution
      - 설정 페이즈에서 결정된 태스크 그래프대로 태스크를 실행

### 설치 필요사항

- JDK 8이상
  - `JAVA_HOME` 환경변수를 설정하여 해당 JDK로 사용
- 필요없는 것
  - groovy library
    - 무조건 그레들에 있는 groovy library만 사용

### 5가지 그래들 기본 개념

- 그래들은 general-purpose의 빌드 툴
  - 어떠한 소프트웨어도 빌드할 수 있도록 함
- 코어 모델은 태스크(units of work) 기반
  - 그래들은 빌드 작업을 태스크들의 DAG(태스크 그래프)로 모델링 함
  - 태스크 그래프가 만들어지고 나서, 어떤 작업을 먼저할지 결정함
  - 태스크의 구성
    - 액션
      - 파일들을 복사하거나, 소스를 컴파일하는 등 무엇인가 하는 것
    - 입력
      - 액션이 사용하거나 작업하는 값, 파일이나 디렉터리들
    - 출력
      - 액션이 수정하거나 생성한 파일이나 디렉터리
  - incremental build지원
    - `clean`하지 않으면 계속해서 incremental build
- 그래들은 빌드 라이프사이클이 존재
  -
- 그래들은 확장 가능함
- 빌드 스크립트는 API에 대해서 동작함

## 기능

### 플러그인

### 태스크 타입

- Build
  - 개요
    - lifecycle task이며, 테스트, production artiract, 도큐멘테이션 전체까지를 담당하기 위한 태스크
- Jar
  - 개요
    - JAR archive를 모음

### 커맨드

- `gradle test` vs `gradle check`
  - `gradle test`
    - 프로젝트에서 모든 유닛테스트를 실행
      - 프로젝트의 모든 유닛테스트 auto-detect
      - 테스트 실행
      - 리포트 생성
  - `gradle check`
    - 다수의 테스트 태스크를 하나로 모을 수 있음
      - 만약 다른 플러그인이 없으면 gradle test와 완전히 동작이 같음(일단 유닛테스트는 포함)
    - 주로 코드 체킹 및 유닛테스트를 수행함
    - e.g) `gradle check -x ktlint -x classes -x jar --parallel --build-cache`

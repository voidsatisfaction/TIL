# Babel

- Babel의 정의
- Babel의 기존 사용
- Babel이 현재 지향하는 것들

## Babel의 정의

- ECMAScript 2015+ 의 코드를 현재나 옛날 버전의 브라우저나 노드같은 환경에서 사용할 수 있도록 하는 자바스크립트 컴파일러 툴
  - 문법 변환
  - polyfill
  - 소스코드 변환
  - 등등
- 현재 지원되는 공식 preset
  - `@babel/preset-env`
  - `@babel/preset-flow`
  - `@babel/preset-react`
  - `@babel/preset-typescript`

## Babel의 기존 사용

[babel의 stage preset을 지우면서 - babel 공식 블로그](https://babeljs.io/blog/2018/07/27/removing-babels-stage-presets)

위의 글에서도 나타나있듯이, 많은 프로젝트에서 바벨의 컴파일러가능을 자바스크립트 개발에서 당연하다는 듯이 사용해왔다. 문제는, babel이 해주는 컴파일 기능이 앞으로 정말 언어 스펙에 들어갈지 아닐지도 모르는 여러 기능들(데코레이터 등등)까지도 지원해준다는 것이었다.

ECMAScript는 직접적으로 언어 스펙에 어떠한 기능이 포함되기 전에 stage-1(기능이 제안된 상태) 부터 stage-3(브라우저 코드에 넣어서 실제로 테스트 하는단계)까지 stage를 거치도록 하면서 많은 개발자들이 자유롭게 토론하도록 한다. 여기서 babel은 앞서 언급한 모든 stage의 기능들을 사용하도록 도와준다.

그런데, stage-3에 있다고 해도 언젠가는 뒤집어질 수 있고, stage-1은 더할나위없이 스펙에 포함되지 않을 가능성도 크다. 그러므로 babel을 이용해서 사용하는 **실험적인** 기능들은 언어에 포함된다는 보장이 없다.

그럼에도 불구하고 babel을 사용해서, 특히 `stage-0`이라는 모든 stage의 기능을 사용할 수 있도록 하는 어마무시한 preset을 사용해서 실제 운용되는 코드를 짜는 일들이 비일비재하다. 이렇게 된다면 이 프로젝트의 코드들은 babel자체에 엄청난 의존을 하게 된다. 만약 ECMAScript위원회에서 데코레이터 기능을 아에 스펙 연구에서 제외한다고 하자. 그렇다면 babel역시도 데코레이터와 같은 기능을 지원하지 않게 될 것이다. 이는 기존 실제 가동되는 서비스 코드에 데코레이터를 사용하는 모든 사람들에게 크나큰 재앙을 안겨줄 것이다.

나 역시 보통 저런식으로 사용해왔다. 당시에는 `stage-2`에 spread연산자 사용이 포함되어있으므로, 아무생각없이 `stage-2`를 babel설정 파일에 넣어두곤 했다.

## Babel이 현재 지향하는 것들

Babel의 근본적인 의의인 **실험단계의 현대적 자바스크립트 기능을 사용하도록 하는 것** 은 계속 유지해나가나, 앞서말한 `stage-x`와 같은 preset은 더 이상 지원하지 않는다고 한다.

그 이유는 다음과 같다.

1. 사람들이 babelscript로 작성해서 과하게 babel에 의존하는 것을 막음
2. babel을 오픈소스로 유지하고 있는데, 많은 다른 오픈소스나 단체로부터 babel의 스펙에 대한 컴플레인이 들어오고 있
3. 앞으로 babel을 발전시켜나감에 있어서 모든 stage의 기능을 preset의 형태로 발전시켜나가기에는 유지보수 비용이 너무 커짐

그래서 현재는, 자신이 직접 하나하나 필요한 부분을 `["@babel/plugin-proposal-pipeline-operator", { "proposal": "minimal" }]` 이렇게 지정하도록 하고, 정확히 어떤 proposal인지 명시하도록 한다.

개인적으로 나도 이러한 방향성에 공감하며, 나 자신도 기술을 아무런 생각없이 쓰기 보다는 명확하게 비용을 생각하고 이해하여 사용해야겠다고 생각한 계기가 되어서 매우 뜻깊었다.

- preset: 특정 기능을 지원하는 여러 plugin의 모음

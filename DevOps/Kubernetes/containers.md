# Containers

## 의문

## 개요

## Images

- 개요
  - 컨테이너 이미지는 애플리케이션과 모든 소프트웨어 의존성을 캡슐화한 바이너리 데이터
- 특징
  - 독자적으로 실행 가능함
  - 애플리케이션 팟을 만들기 전에 레지스트리에 푸시하고 참조하게 하는 것이 기본

### 이미지 업데이트

- 이미지 pull 정책
  - 개요
    - kubelet이 특정 이미지를 풀하려고 할 때 영향을 주는 정책
  - 종류
    - `IfNotPresent`(default)
      - 이미지가 로컬에 없는 경우에만 내려받음
    - `Always`
      - 컨테이너 기동시 마다, kubelet이 컨테이너 이미지 레지스트리에 이름과 이미지의 다이제스트가 있는지 질의하고, 일치하는 다이제스트를 가진 컨테이너 이미지가 로컬에 있으면 kubelet은 캐시된 이미지를 사용하고, 그 외의 경우는 검색된 다이제스트를 가진 이미지를 내려받아서 사용
        - **다이제스트를 사용한다는 것이 중요(단순히 image-name:tag비교가 아니라 image-name:digest)**
          - 코드를 변경해도 다이제스트는 변해서 정말 같은 버전인것을 보장
    - `Never`
      - 이미지를 가져오지 않고, 오직 로컬에 존재하는 경우에만 실행
- ImagePullBackoff
  - 개요
    - kubelet이 컨테이너 런타임을 이용하여 팟의 컨테이너 생성을 시작할 때, `ImagePullBackOff`로 인해 컨테이너가 waiting상태에 있을 수 있음
  - 원인
    - 이미지 이름이 잘못됨, imagePullSecret 없이 비공개 레지스트리에서 풀링 시도로 인하여 k8s가 컨테이너 이미지를 가져올 수 없어서 컨테이너를 실행할 수 없음을 의미
  - Backoff
    - 시간 간격을 늘려가며 계속해서 시도하며, 시간 간격의 상항은 300초(5분)

# hypothesis testing(가설 검증)

- 가설이 실현될 가능성이 5% 미만이면(보통 5%) 그 가설은 기각된다고 하자

## 가설 검증의 아이디어

### 가설 검증의 아이디어 기본

- `P(a) = 99%`라고 하자(어떠한 사건 a가 참일 확률이 99%)
  - 이 a라는 사건을 100번 시행했을경우
  - `P(a 100/100)`(100번 시행해서 100번 모두 참인 케이스의 경우의 비율) == 36.6%
  - `P(a 99/100)` == 37.0%
  - `P(a 98/100)` == 19.5%
  - `P(a 97/100)` == 6.0%
  - `P(a 96/100)` == 1.5%
  - `P(a 95/100)` == 0.3%
- 어떠한 가설이 참일 확률이 99%라고 가정하자
  - 결과적으로 그 가설에 대한 시험을 100번 시행했는데, 참인 케이스가 95회
  - 이는 통계적 거짓임
  - 왜냐하면 가설이 참일 확률이 `99%`인데 100번중 95번만이 참이면, 그러한 일이 일어날 확률은 `0.3%`밖에 되지 않음
  - 그 가설은 기각됨
  - 통계적으로는 일정한 경계(threshhold)가 있음
  - **위의 경우 p값이 0.003이었던것임**

### 귀무가설(null hypothesis)와 대립 가설(alternative hypothesis)의 예

- 귀무가설(H0): no difference(일반적으로 원래 그래야 하는 것)
- 대립가설(Ha): difference (놀라운 결과, 뉴스가 되는 것, 의심하는것)
  - 결국은 표본으로 모수(population)을 추정하겠다는 것

### P-값을 비교하는 유의 수준(significance level)

![](./images/pvalue_significance_level.png)

- 유의수준을 먼저 정하자(실험하기 전에)
- p값
  - **귀무가설이 참이라고 했을 때, 귀무 가설을 어느정도 큰 표본으로(횟수) 시행했을 때 같은 결과를 얻을 수 있는 확률**
    - p값이 매우 작으면 귀무가설을 기각할 수 있음
  - 위의 가설 검증의 아이디어와 같음
  - e.g 귀무가설을 이 참일확률이 50%일때, 100번 시행해서 59번이 참인 경우가 등장하면? p값은 0.036
    - 유의 수준(알파) == 0.05
      - 0.036 < 0.05
      - 귀무가설 기각
      - 대립가설 채용(suggest)
    - 유의 수준(알파) == 0.01
      - 0.036 >= 0.01
      - **귀무가설 기각의 실패**
      - **귀무가설 채용(x)**
    - 그래서 유의 수준을 실험 전에 결정하는 것이 매우 중요

![](./images/p_value_t_value.png)

- 귀무가설은 위의 그래프의 곡선이라고 생각하면 된다.
- t/f값은 테스트(표본의 검사)에서 주어진 t/f값이 나온 위치이다.
- p값은 귀무가설이 참일때, t값이 나온 경우 실제로 그렇게 되거나 그렇게 될 이상의 확률이다.
- e.g
  - 두 집단의 평균에 유의미한 차가 있는지 없는지 분석하고싶음
  - 유의 수준을 정함(알파값)
  - t-test를 행해서 t값을 구함
    - 즉, 두 집단이 평균의 차가 없다고 생각한 뒤에 샘플의 평균 값의 차가 t값이 되었다.
  - t값에 대한 p값을 구함
    - 즉 두 집단이 평균의 차가 없다고 생각한 뒤에 t값이 될 확률값을 구함 그것이 p값임
  - p값이 앞서 정한 알파값보다 큰지 작은지 확인
    - 크면 귀무가설 기각할 수 없음
    - 작으면 귀무가설 기각 가능함

### 시뮬레이션에서 P-값을 추정(estimating)

![](./images/p_value_from_simulation1.png)

![](./images/p_value_from_simulation2.png)

## 에러 확률과 힘(Error probabilities and power)

![](./images/type1_type2_error.png)

유의 수준에 관한 이야기

- Type1 에러
- Type2 에러

### Type1 에러

- 귀무가설이 참인데 기각한 경우
- `1%`의 유의 수준인 경우 p-값이 `0.5%`일때 보통은 귀무가설은 기각됨
  - 그러나 진짜로 귀무가설을 채용했을 때 `0.5%`의 확률로 그러한 결과가 나올 수 있음
  - 따라서 `0.5%`가 type1 에러가 나올 확률(**p-값이랑 동일**)

### Type2 에러의

- 귀무가설이 거짓인데 기각에 실패한 경우

### 유의 수준 테스트에서의 파워(power)의 소개

![](./images/power_significance.png)

- 일종의 확률
- 귀무 가설이 거짓일 떄, 올바른 판단(기각)을 할 확률
  - `Power = P(rejecting H0 | H0 false)`
  - `= 1 - P(not rejecting H0 | H0 false)`
  - `= 1 - P(Type2 error)`
  - Type2 에러를 저지르지 않을 확률
- 파워 상승법
  - 알파(유의수준) 상승 => 파워 상승 => 타입1 에러 확률 상승
  - **표본 크기 상승 => 파워 상승(그래프가 더 폭이 좁아짐)**
      - 이는 항상 바람직함
  - 데이터 다양성(varibility) 저하 => 파워 상승(그래프가 더 폭이 좁아짐)
  - 참 매개변수(true parameter)가 귀무 가설에서의 변수보다 멀리 떨어짐(이는 실험 설계자가 제어할 수 없음) => 파워 상승
- 파워 제어
  - 실험의 특징에 따라서 다른 파워를 두어야 함
  - 어떠한 실험은 Type1 에러에 치명적이고, 어떠한 실험은 Type2 에러에 치명적
    - e.g H0: 수영장의 물의 위생상태는 허용 수준, Ha: 수영장의 물은 허용이 불가능(오염)

## 모비율(population proportion)에 대한 테스트

### 모비율 유의(significance) 테스트를 위한 가설 세우기

### 모비율 유의 테스트에 대한 z-test의 조건

![](./images/z-test-condition.png)

### 일정 비율에서 통계적 추론을 하기 위한 조건

- 임의성(Random)
  - 데이터는 무작위 샘플로 구성되어야 함
- 정규성(Normal)
  -
- 독립성(Independent)
